import{a as u,c as D}from"./chunk-OYL6LJLT.js";import{b as y}from"./chunk-GG34XMCG.js";import{d as T,e as P,l as N,s as k}from"./chunk-6CUNOLLP.js";import{C as H,z as w}from"./chunk-PY2MZTIA.js";import"./chunk-QHSPJAHQ.js";import"./chunk-2V72WRPO.js";import{$a as t,Hb as i,Ib as e,Nb as h,Rb as f,Sb as b,bc as o,cc as m,da as O,dc as M,ec as g,la as v,lb as I,ma as E,nc as r,oc as p,qb as S,yb as x}from"./chunk-3V6P7TZ6.js";function A(s,c){if(s&1){let a=h();i(0,"button",9),f("click",function(){v(a);let d=b();return E(d.openNotifications())}),o(1),r(2,"translate"),e()}s&2&&(t(),M(" ",p(2,1,"HOME.SHOW_NOTIFICATIONS")," "))}function V(s,c){if(s&1&&(i(0,"li"),o(1),e()),s&2){let a=c.$implicit;t(),m(a)}}function z(s,c){if(s&1&&(i(0,"li")(1,"div",18)(2,"strong"),o(3),r(4,"translate"),e(),i(5,"ul"),S(6,V,2,1,"li",16),e()()()),s&2){let a=c.$implicit;t(3),g("",p(4,3,"HOME.LOT")," ",a.code,":"),t(3),x("ngForOf",a.messages)}}function F(s,c){if(s&1){let a=h();i(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),o(4,"\u24D8"),e(),i(5,"h3"),o(6),r(7,"translate"),e()(),i(8,"button",14),f("click",function(){v(a);let d=b();return E(d.closeNotifications())}),o(9,"\u2715"),e()(),i(10,"ul",15),S(11,z,7,5,"li",16),e(),i(12,"button",17),f("click",function(){v(a);let d=b();return E(d.viewMoreNotifications())}),o(13),r(14,"translate"),e()()}if(s&2){let a=b();t(6),m(p(7,3,"HOME.RECENT_NOTIFICATIONS")),t(5),x("ngForOf",a.notificationsGrouped),t(2),M(" ",p(14,5,"HOME.VIEW_MORE_DETAILS")," ")}}var B=class s{batchService=O(D);authService=O(y);router=O(k);supplierName="Telas del Sur";lotSummary={pending:0,sent:0,confirmed:0};notificationsGrouped=[];showNotifications=!0;ngOnInit(){let c=this.authService.getCurrentUser();if(!c||!c.id){console.error("No hay usuario autenticado o falta ID"),this.authService.logout();return}let a=c.id;this.batchService.getBySupplierId(a).subscribe(l=>{let d={pending:0,sent:0,confirmed:0},_={},L=[...l].sort((n,C)=>new Date(C.date).getTime()-new Date(n.date).getTime());for(let n of L)n.status===u.PENDIENTE||n.status===u.POR_ENVIAR?(d.pending++,_[n.code]||(_[n.code]=[]),n.status===u.POR_ENVIAR&&_[n.code].push(`Recuerda enviar el lote ${n.code} hoy.`),n.observations&&n.observations.trim()!==""&&_[n.code].push(`Dej\xF3 una observaci\xF3n en el lote ${n.code}.`),(!n.imageUrl||n.imageUrl.trim()==="")&&_[n.code].push(`Falta evidencia en el lote ${n.code}.`)):n.status===u.ENVIADO?d.sent++:(n.status===u.ACEPTADO||n.status===u.COMPLETADO)&&d.confirmed++;this.lotSummary=d,this.notificationsGrouped=Object.entries(_).map(([n,C])=>({code:n,messages:C}))})}viewDetails(c){switch(c){case"pendientes":this.router.navigate(["/supplier/registrar-lotes"]);break;case"enviados":case"confirmados":this.router.navigate(["/supplier/mis-lotes"]);break;default:console.log(`Vista no definida para: ${c}`)}}viewMoreNotifications(){this.router.navigate(["/supplier/mis-lotes"])}closeNotifications(){this.showNotifications=!1}openNotifications(){this.showNotifications=!0}static \u0275fac=function(a){return new(a||s)};static \u0275cmp=I({type:s,selectors:[["app-supplier-home"]],decls:47,vars:45,consts:[[1,"dashboard-container"],[1,"welcome-section"],[1,"stats-container"],[1,"stat-card"],[1,"stat-number"],[1,"stat-description"],[1,"btn-details",3,"click"],["class","btn-show-notifications",3,"click",4,"ngIf"],["class","notifications-container",4,"ngIf"],[1,"btn-show-notifications",3,"click"],[1,"notifications-container"],[1,"notifications-header"],[1,"notifications-title"],[1,"notification-icon"],[1,"close-btn",3,"click"],[1,"notifications-list"],[4,"ngFor","ngForOf"],[1,"btn-more-details",3,"click"],[1,"notification-item"]],template:function(a,l){a&1&&(i(0,"div",0)(1,"div",1)(2,"h1"),o(3),r(4,"translate"),e(),i(5,"p"),o(6),r(7,"translate"),e()(),i(8,"div",2)(9,"div",3)(10,"h2"),o(11),r(12,"translate"),e(),i(13,"p",4),o(14),r(15,"translate"),e(),i(16,"small",5),o(17),r(18,"translate"),e(),i(19,"button",6),f("click",function(){return l.viewDetails("pendientes")}),o(20),r(21,"translate"),e()(),i(22,"div",3)(23,"h2"),o(24),r(25,"translate"),e(),i(26,"p",4),o(27),r(28,"translate"),e(),i(29,"button",6),f("click",function(){return l.viewDetails("enviados")}),o(30),r(31,"translate"),e()(),i(32,"div",3)(33,"h2"),o(34),r(35,"translate"),e(),i(36,"p",4),o(37),r(38,"translate"),e(),i(39,"small",5),o(40),r(41,"translate"),e(),i(42,"button",6),f("click",function(){return l.viewDetails("confirmados")}),o(43),r(44,"translate"),e()()(),S(45,A,3,3,"button",7)(46,F,15,7,"div",8),e()),a&2&&(t(3),g("",p(4,19,"HOME.WELCOME"),", ",l.supplierName,""),t(3),m(p(7,21,"HOME.WELCOME_DESCRIPTION")),t(5),m(p(12,23,"HOME.LOTS_TO_SEND")),t(3),g("",l.lotSummary.pending," ",p(15,25,"HOME.LOTS"),""),t(3),m(p(18,27,"HOME.PENDING_PLUS_TO_SEND")),t(3),m(p(21,29,"HOME.VIEW_DETAILS")),t(4),m(p(25,31,"HOME.LOTS_SENT")),t(3),g("",l.lotSummary.sent," ",p(28,33,"HOME.LOTS"),""),t(3),m(p(31,35,"HOME.VIEW_DETAILS")),t(4),m(p(35,37,"HOME.LOTS_CONFIRMED")),t(3),g("",l.lotSummary.confirmed," ",p(38,39,"HOME.LOTS"),""),t(3),m(p(41,41,"HOME.ACCEPTED_PLUS_COMPLETED")),t(3),m(p(44,43,"HOME.VIEW_DETAILS")),t(2),x("ngIf",!l.showNotifications),t(),x("ngIf",l.showNotifications))},dependencies:[N,T,P,H,w],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px;max-width:900px;margin:0 auto;font-family:Arial,sans-serif}.stat-description[_ngcontent-%COMP%]{display:block;color:#666;font-size:12px;margin-top:4px;margin-bottom:8px}.welcome-section[_ngcontent-%COMP%]{margin-bottom:30px}.welcome-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:#333}.welcome-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-size:16px}.stats-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:30px;gap:20px}.stat-card[_ngcontent-%COMP%]{flex:1;background-color:#fff;border:1px solid #ddd;padding:20px;border-radius:4px;text-align:center}.stat-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;color:#555;margin-bottom:10px}.stat-number[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-bottom:15px;color:#333}.btn-details[_ngcontent-%COMP%]{background-color:#8a7155;color:#fff;border:none;padding:8px 15px;border-radius:4px;cursor:pointer;font-size:14px}.btn-details[_ngcontent-%COMP%]:hover{background-color:#6e5a43}.notifications-container[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:4px;padding:15px}.notifications-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.notifications-title[_ngcontent-%COMP%]{display:flex;align-items:center}.notification-icon[_ngcontent-%COMP%]{margin-right:10px;font-size:18px;color:#555}.notifications-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;color:#333;margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:16px;color:#777;cursor:pointer}.notifications-list[_ngcontent-%COMP%]{list-style-type:disc;padding-left:20px;margin-bottom:15px}.notifications-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;color:#555}.btn-more-details[_ngcontent-%COMP%]{background-color:#8a7155;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:14px;display:block;width:140px;text-align:center}.btn-show-notifications[_ngcontent-%COMP%]{background-color:#8a7155;color:#fff;border:none;padding:8px 15px;margin:10px 0;border-radius:4px;cursor:pointer;font-size:14px}.btn-show-notifications[_ngcontent-%COMP%]:hover{background-color:#6e5a43}"]})};export{B as SupplierHomeComponent};
