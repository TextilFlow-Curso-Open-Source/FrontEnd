import{a as f,b as v}from"./chunk-YNTG2JIL.js";import{a as c,b as y}from"./chunk-ONYPU5BJ.js";import{g as h}from"./chunk-XMN5GRMF.js";import{C as l,N as m,Z as g,ca as d,p as u,s as o}from"./chunk-ZUXVFBKG.js";var p=class extends f{companyName;ruc;specialization;description;certifications;logo;constructor(e){super(e),this.companyName=e.companyName||"",this.ruc=e.ruc||"",this.specialization=e.specialization||"",this.description=e.description||"",this.certifications=e.certifications||"",this.logo=e.logo||""}};var S=class s extends y{constructor(t){super();this.authService=t;this.resourceEndpoint=c.supplierEndpointPath}getProfileByUserId(t){return this.customRequest(`/suppliers/${t}`,"GET").pipe(o(r=>{let i=this.authService.getCurrentUser();return this.transformBackendToFrontend(r,i)}))}updateProfile(t,r){let i={companyName:r.companyName,ruc:r.ruc,specialization:r.specialization,description:r.description,certifications:r.certifications,name:r.name,email:r.email,country:r.country,city:r.city,address:r.address,phone:r.phone};return this.customRequest(`/suppliers/${t}`,"PUT",i).pipe(o(n=>this.transformBackendToFrontend(n,null)))}transformBackendToFrontend(t,r){let i=r||this.authService.getCurrentUser();return new p({id:t.userId?.toString()||t.id?.toString(),name:t.name||i?.name||"",email:t.email||i?.email||"",role:"supplier",country:t.country||i?.country||"",city:t.city||i?.city||"",address:t.address||i?.address||"",phone:t.phone||i?.phone||"",companyName:t.companyName||"",ruc:t.ruc||"",specialization:t.specialization||"",description:t.description||"",logo:t.logoUrl||"",certifications:t.certifications||""})}getAllSuppliers(){return this.customRequest("/suppliers","GET").pipe(o(t=>t.map(r=>this.transformBackendToFrontend(r,null))))}getProfileByEmail(t){return this.getAllSuppliers().pipe(o(r=>r.find(i=>i.email===t)))}getProfileById(t){return this.getProfileByUserId(t)}uploadFile(t,r){let i=`${this.serverBaseUrl}${t}`,n=new h,a=localStorage.getItem("auth_token");return a&&!a.startsWith("fake-jwt-token-")&&!a.startsWith("temp-jwt-token-")&&(n=n.set("Authorization",`Bearer ${a}`)),this.http.post(i,r,{headers:n}).pipe(m(2),l(E=>u(()=>new Error(`Upload error: ${E.status}`))))}uploadLogo(t,r){let i=new FormData;i.append("file",r);let n=`${c.profileEndpointPath}/${t}/images/logo`;return this.uploadFile(n,i)}deleteLogo(t){let r=`${c.profileEndpointPath}/${t}/images/logo`;return this.customRequest(r,"DELETE")}static \u0275fac=function(r){return new(r||s)(d(v))};static \u0275prov=g({token:s,factory:s.\u0275fac,providedIn:"root"})};export{p as a,S as b};
