import{a as b,b as v}from"./chunk-GG34XMCG.js";import{a as u,b as h}from"./chunk-QHSPJAHQ.js";import{g as y}from"./chunk-2V72WRPO.js";import{C as p,N as l,Z as g,ca as d,p as c,s as n}from"./chunk-3V6P7TZ6.js";var m=class extends b{companyName;ruc;businessType;description;website;logo;constructor(s){super(s),this.companyName=s.companyName||"",this.ruc=s.ruc||"",this.businessType=s.businessType||"",this.description=s.description||"",this.website=s.website||"",this.logo=s.logo||""}};var f=class o extends h{constructor(t){super();this.authService=t;this.resourceEndpoint=u.businessmanEndpointPath}getProfileByUserId(t){return this.customRequest(`/businessmen/${t}`,"GET").pipe(n(e=>{let r=this.authService.getCurrentUser();return this.transformBackendToFrontend(e,r)}))}updateProfile(t,e){let r={companyName:e.companyName,ruc:e.ruc,businessType:e.businessType,description:e.description,website:e.website,name:e.name,email:e.email,country:e.country,city:e.city,address:e.address,phone:e.phone};return this.customRequest(`/businessmen/${t}`,"PUT",r).pipe(n(i=>this.transformBackendToFrontend(i,null)))}transformBackendToFrontend(t,e){let r=e||this.authService.getCurrentUser();return new m({id:r?.id||t.userId?.toString(),name:t.name||r?.name||"",email:t.email||r?.email||"",role:"businessman",country:t.country||r?.country||"",city:t.city||r?.city||"",address:t.address||r?.address||"",phone:t.phone||r?.phone||"",companyName:t.companyName||"",ruc:t.ruc||"",businessType:t.businessType||"",website:t.website||"",description:t.description||"",logo:t.logoUrl||""})}getAllBusinessmen(){return this.customRequest("/businessmen","GET").pipe(n(t=>t.map(e=>this.transformBackendToFrontend(e,null))))}getProfileByEmail(t){return this.getAllBusinessmen().pipe(n(e=>e.find(r=>r.email===t)))}getProfileById(t){return this.getProfileByUserId(t)}uploadFile(t,e){let r=`${this.serverBaseUrl}${t}`,i=new y,a=localStorage.getItem("auth_token");return a&&!a.startsWith("fake-jwt-token-")&&!a.startsWith("temp-jwt-token-")&&(i=i.set("Authorization",`Bearer ${a}`)),this.http.post(r,e,{headers:i}).pipe(l(2),p(B=>c(()=>new Error(`Upload error: ${B.status}`))))}uploadLogo(t,e){let r=new FormData;r.append("file",e);let i=`${u.profileEndpointPath}/${t}/images/logo`;return this.uploadFile(i,r)}deleteLogo(t){let e=`${u.profileEndpointPath}/${t}/images/logo`;return this.customRequest(e,"DELETE")}static \u0275fac=function(e){return new(e||o)(d(v))};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{m as a,f as b};
