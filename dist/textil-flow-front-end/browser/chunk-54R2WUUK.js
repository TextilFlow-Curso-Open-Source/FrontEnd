import{a as xe}from"./chunk-4CHIIT47.js";import{b as fe}from"./chunk-4ELXKTBC.js";import{b as ve}from"./chunk-PQAOWLFY.js";import{a as he}from"./chunk-7L5BX6GK.js";import{f as me}from"./chunk-47QM3S6D.js";import{S as ue,c as ae,g as oe,j as se,q as pe}from"./chunk-WV37CKRB.js";import"./chunk-UTGZS7YI.js";import{a as q,b as _e,c as ge}from"./chunk-5WSPT6UI.js";import{b as ce}from"./chunk-YNTG2JIL.js";import{c as X,d as Z,e as $,j as ee,l as te}from"./chunk-27FP4Y7A.js";import{C as re,x as ie,z as ne}from"./chunk-XE5R4NI6.js";import{a as le,b as de}from"./chunk-ONYPU5BJ.js";import"./chunk-XMN5GRMF.js";import{$a as a,Ab as I,C as W,Hb as o,Ib as r,Jb as M,Nb as A,Rb as f,Sb as m,Vb as S,Z as H,Za as L,a as k,b as F,bc as p,ca as G,cc as h,dc as P,eb as O,ec as J,g as B,gc as w,hc as b,ic as C,la as _,lb as K,ma as g,mc as E,nc as d,o as U,oc as c,pc as z,qb as R,s as T,y as Y,yb as u}from"./chunk-ZUXVFBKG.js";var V=class{id;supplierId;businessmanId;rating;comment;createdAt;businessmanName;businessmanLogo;canEdit;constructor(i){this.id=i.id,this.supplierId=i.supplierId,this.businessmanId=i.businessmanId,this.rating=i.rating,this.comment=i.comment||"",this.createdAt=i.createdAt||new Date().toISOString(),this.businessmanName=i.businessmanName,this.businessmanLogo=i.businessmanLogo||"assets/default-avatar.png",this.canEdit=i.canEdit||!1}isValid(){return this.rating>=1&&this.rating<=5&&this.supplierId.length>0&&this.businessmanId.length>0}getStarsArray(){return Array.from({length:5},(i,e)=>e<this.rating)}getFormattedDate(){try{return new Date(this.createdAt).toLocaleDateString()}catch{return this.createdAt}}};var be=le.supplierReviewEndpointPath,N=class l extends de{constructor(e){super();this.businessmanService=e;this.resourceEndpoint=be}addReview(e,n,t,s,x){let v={supplierId:this.transformIdToLong(e),businessmanId:this.transformIdToLong(n),rating:t,reviewContent:s};return this.customRequest(`${this.resourceEndpoint}`,"POST",v).pipe(T(D=>this.transformBackendToFrontend(D,x)))}getReviewsForSupplier(e,n){if(!e||e==="null"||e==="undefined"){console.error("supplierId is invalid:",e),n([]);return}let t=this.transformIdToLong(e);this.customRequest(`${this.resourceEndpoint}/supplier/${t}`,"GET").subscribe({next:s=>{this.enrichReviewsWithBusinessmanNames(s).subscribe({next:x=>{n(x)},error:x=>{console.error("Error enriching reviews:",x);let v=s.map(D=>this.transformBackendToFrontend(D));n(v)}})},error:s=>{console.error("Error getting reviews:",s),n([])}})}calculateAverageRating(e,n){this.getReviewsForSupplier(e,t=>{if(!t||t.length===0){n(0,0);return}let x=t.reduce((v,D)=>v+D.rating,0)/t.length;n(x,t.length)})}hasBusinessmanReviewed(e,n,t){let s=this.transformIdToLong(e),x=this.transformIdToLong(n);this.customRequest(`${this.resourceEndpoint}/check/${s}/${x}`,"GET").subscribe({next:v=>{t(v)},error:v=>{console.error("Error checking reviews:",v),t(!1)}})}updateReview(e,n,t){let s={rating:n,reviewContent:t},x=this.transformIdToLong(e);return this.customRequest(`${this.resourceEndpoint}/${x}`,"PUT",s).pipe(T(v=>this.transformBackendToFrontend(v)))}transformBackendToFrontend(e,n){return new V({id:this.transformIdToString(e.id),supplierId:this.transformIdToString(e.supplierId),businessmanId:this.transformIdToString(e.businessmanId),rating:e.rating,comment:e.reviewContent,createdAt:e.createdAt,businessmanName:n})}enrichReviewsWithBusinessmanNames(e){if(!e||e.length===0)return U([]);let t=[...new Set(e.map(s=>this.transformIdToString(s.businessmanId)))].map(s=>this.businessmanService.getProfileByUserId(s).pipe(T(x=>({id:s,name:x.name,logo:x.logo||"assets/default-avatar.png"})),W(()=>U({id:s,name:"Usuario",logo:"assets/default-avatar.png"}))));return Y(t).pipe(T(s=>{let x=new Map;return s.forEach(v=>{v&&x.set(v.id,{name:v.name,logo:v.logo})}),e.map(v=>{let D=this.transformIdToString(v.businessmanId),Q=x.get(D)||{name:"Usuario",logo:"assets/default-avatar.png"},j=this.transformBackendToFrontend(v,Q.name);return j.businessmanLogo=Q.logo,j})}),W(()=>U(e.map(s=>this.transformBackendToFrontend(s)))))}getReviewsForSupplierObservable(e){return new B(n=>{this.getReviewsForSupplier(e,t=>{n.next(t),n.complete()})})}hasBusinessmanReviewedObservable(e,n){return new B(t=>{this.hasBusinessmanReviewed(e,n,s=>{t.next(s),t.complete()})})}calculateAverageRatingObservable(e){return new B(n=>{this.calculateAverageRating(e,(t,s)=>{n.next({average:t,total:s}),n.complete()})})}static \u0275fac=function(n){return new(n||l)(G(fe))};static \u0275prov=H({token:l,factory:l.\u0275fac,providedIn:"root"})};var y=l=>({filled:l});function Re(l,i){if(l&1){let e=A();o(0,"button",15),f("click",function(){_(e);let t=m();return g(t.clearSearch())}),o(1,"i",16),p(2,"close"),r()()}}function Ee(l,i){l&1&&(o(0,"div",17),p(1),d(2,"translate"),r()),l&2&&(a(),P(" ",c(2,1,"ADD_SUPPLIER.LOADING")," "))}function Ie(l,i){l&1&&(o(0,"p"),p(1),d(2,"translate"),r()),l&2&&(a(),h(c(2,1,"ADD_SUPPLIER.NO_SUPPLIERS")))}function Pe(l,i){l&1&&(o(0,"p"),p(1),d(2,"translate"),r()),l&2&&(a(),h(c(2,1,"ADD_SUPPLIER.NO_AVAILABLE_SUPPLIERS")))}function ye(l,i){l&1&&(o(0,"p"),p(1),d(2,"translate"),r()),l&2&&(a(),h(c(2,1,"ADD_SUPPLIER.NO_SEARCH_RESULTS")))}function Ae(l,i){if(l&1&&(o(0,"div",18),R(1,Ie,3,3,"p",19)(2,Pe,3,3,"p",19)(3,ye,3,3,"p",19),r()),l&2){let e=m();a(),u("ngIf",e.activeTab==="current"),a(),u("ngIf",e.activeTab==="add"),a(),u("ngIf",e.searchTerm.trim())}}function De(l,i){l&1&&(o(0,"div",32)(1,"span",33),p(2,"\u2606"),r(),o(3,"span",33),p(4,"\u2606"),r(),o(5,"span",33),p(6,"\u2606"),r(),o(7,"span",33),p(8,"\u2606"),r(),o(9,"span",33),p(10,"\u2606"),r(),o(11,"span",34),p(12,"(Sin calificaciones)"),r()())}function Oe(l,i){if(l&1&&(o(0,"div",32)(1,"span",35),p(2,"\u2605"),r(),o(3,"span",35),p(4,"\u2605"),r(),o(5,"span",35),p(6,"\u2605"),r(),o(7,"span",35),p(8,"\u2605"),r(),o(9,"span",35),p(10,"\u2605"),r()()),l&2){let e=m().$implicit;a(),u("ngClass",E(5,y,e.averageRating>=1)),a(2),u("ngClass",E(7,y,e.averageRating>=2)),a(2),u("ngClass",E(9,y,e.averageRating>=3)),a(2),u("ngClass",E(11,y,e.averageRating>=4)),a(2),u("ngClass",E(13,y,e.averageRating>=5))}}function Me(l,i){if(l&1){let e=A();o(0,"app-button",43),d(1,"translate"),f("click",function(){_(e);let t=m(2).$implicit,s=m(2);return g(s.openReviewForm(t.id))}),r()}l&2&&S("label",c(1,1,"ADD_SUPPLIER.ADD_REVIEW"))}function Te(l,i){if(l&1){let e=A();o(0,"app-button",55),d(1,"translate"),f("click",function(){_(e);let t=m().$implicit,s=m(5);return g(s.editReview(t))}),r()}l&2&&S("label",c(1,1,"ADD_SUPPLIER.EDIT_REVIEW"))}function Le(l,i){if(l&1&&(o(0,"div",46)(1,"div",47),M(2,"img",48),o(3,"div",49)(4,"div",50),p(5),d(6,"translate"),r(),o(7,"div",51)(8,"span",35),p(9,"\u2605"),r(),o(10,"span",35),p(11,"\u2605"),r(),o(12,"span",35),p(13,"\u2605"),r(),o(14,"span",35),p(15,"\u2605"),r(),o(16,"span",35),p(17,"\u2605"),r()(),o(18,"div",52),p(19),d(20,"date"),r()(),R(21,Te,2,3,"app-button",53),r(),o(22,"p",54),p(23),d(24,"translate"),r()()),l&2){let e=i.$implicit;a(2),u("src",e.businessmanLogo||"assets/default-avatar.png",L),a(3),h(e.businessmanName||c(6,10,"COMMON.USER")),a(3),u("ngClass",E(17,y,(e.rating||0)>=1)),a(2),u("ngClass",E(19,y,(e.rating||0)>=2)),a(2),u("ngClass",E(21,y,(e.rating||0)>=3)),a(2),u("ngClass",E(23,y,(e.rating||0)>=4)),a(2),u("ngClass",E(25,y,(e.rating||0)>=5)),a(3),h(z(20,12,e.createdAt,"dd/MM/yy")),a(2),u("ngIf",e.canEdit),a(2),h(e.comment||c(24,15,"ADD_SUPPLIER.NO_COMMENTS"))}}function Be(l,i){if(l&1&&(o(0,"div",44),R(1,Le,25,27,"div",45),r()),l&2){let e=m(4);a(),u("ngForOf",e.reviews)}}function Ue(l,i){l&1&&(o(0,"div",56),p(1),d(2,"translate"),r()),l&2&&(a(),P(" ",c(2,1,"ADD_SUPPLIER.NO_REVIEWS")," "))}function Ve(l,i){if(l&1&&(o(0,"div",36)(1,"div",37)(2,"h4"),p(3),d(4,"translate"),r(),o(5,"p")(6,"strong"),p(7),d(8,"translate"),r(),p(9),d(10,"translate"),r(),o(11,"p")(12,"strong"),p(13),d(14,"translate"),r(),p(15),d(16,"translate"),r(),o(17,"p")(18,"strong"),p(19),d(20,"translate"),r(),p(21),d(22,"translate"),r(),o(23,"p")(24,"strong"),p(25),d(26,"translate"),r(),p(27),d(28,"translate"),r()(),o(29,"div",38)(30,"div",39)(31,"h4"),p(32),d(33,"translate"),r(),R(34,Me,2,3,"app-button",40),r(),R(35,Be,2,1,"div",41)(36,Ue,3,3,"div",42),r()()),l&2){let e=m().$implicit,n=m(2);a(3),h(c(4,14,"ADD_SUPPLIER.SUPPLIER_INFO")),a(4),P("",c(8,16,"ADD_SUPPLIER.SPECIALIZATION"),":"),a(2),P(" ",e.specialization||(e.profile==null?null:e.profile.specialization)||c(10,18,"ADD_SUPPLIER.NO_SPECIFIED"),""),a(4),P("",c(14,20,"ADD_SUPPLIER.CATEGORIES"),":"),a(2),P(" ",(e.productCategories==null?null:e.productCategories.join(", "))||(e.profile==null||e.profile.productCategories==null?null:e.profile.productCategories.join(", "))||c(16,22,"ADD_SUPPLIER.NO_SPECIFIED"),""),a(4),P("",c(20,24,"ADD_SUPPLIER.LOCATION"),":"),a(2),P(" ",e.warehouseLocation||(e.profile==null?null:e.profile.warehouseLocation)||c(22,26,"ADD_SUPPLIER.NO_SPECIFIED"),""),a(4),P("",c(26,28,"ADD_SUPPLIER.MIN_ORDER"),":"),a(2),P(" ",e.minimumOrderQuantity||(e.profile==null?null:e.profile.minimumOrderQuantity)||c(28,30,"ADD_SUPPLIER.NO_SPECIFIED"),""),a(5),J("",c(33,32,"ADD_SUPPLIER.REVIEWS")," (",e.totalReviews||0,")"),a(2),u("ngIf",n.canAddReview),a(),u("ngIf",n.reviews.length>0),a(),u("ngIf",n.reviews.length===0)}}function Ne(l,i){if(l&1){let e=A();o(0,"div",22)(1,"div",23),f("click",function(){let t=_(e).$implicit,s=m(2);return g(s.toggleSupplierExpansion(t.id))}),o(2,"h3",24),p(3),d(4,"translate"),r(),M(5,"div",25),r(),o(6,"div",26)(7,"div",27),M(8,"img",28),o(9,"span"),p(10),r()(),R(11,De,13,0,"div",29)(12,Oe,11,15,"div",29),o(13,"app-button",30),d(14,"translate"),f("click",function(){let t=_(e).$implicit,s=m(2);return g(s.showBatchFormFor(t))}),r()(),R(15,Ve,37,34,"div",31),r()}if(l&2){let e=i.$implicit,n=m(2);a(3),h(e.companyName||(e.profile==null?null:e.profile.companyName)||c(4,10,"ADD_SUPPLIER.NO_COMPANY_NAME")),a(2),I("expanded",n.expandedSupplierId===e.id),a(3),u("src",(e.profile==null?null:e.profile.logo)||"assets/default-avatar.png",L),a(2),h(e.email),a(),u("ngIf",!e.averageRating||e.averageRating===0),a(),u("ngIf",e.averageRating&&e.averageRating>0),a(),S("label",c(14,12,"ADD_SUPPLIER.ORDER_BATCH")),u("fullWidth",!1),a(2),u("ngIf",n.expandedSupplierId===e.id)}}function ke(l,i){if(l&1&&(o(0,"div",20),R(1,Ne,16,14,"div",21),r()),l&2){let e=m();a(),u("ngForOf",e.filteredSuppliers)}}function Fe(l,i){l&1&&(o(0,"div",32)(1,"span",33),p(2,"\u2606"),r(),o(3,"span",33),p(4,"\u2606"),r(),o(5,"span",33),p(6,"\u2606"),r(),o(7,"span",33),p(8,"\u2606"),r(),o(9,"span",33),p(10,"\u2606"),r(),o(11,"span",34),p(12,"(Sin calificaciones)"),r()())}function We(l,i){if(l&1&&(o(0,"div",32)(1,"span",35),p(2,"\u2605"),r(),o(3,"span",35),p(4,"\u2605"),r(),o(5,"span",35),p(6,"\u2605"),r(),o(7,"span",35),p(8,"\u2605"),r(),o(9,"span",35),p(10,"\u2605"),r()()),l&2){let e=m().$implicit;a(),u("ngClass",E(5,y,e.averageRating>=1)),a(2),u("ngClass",E(7,y,e.averageRating>=2)),a(2),u("ngClass",E(9,y,e.averageRating>=3)),a(2),u("ngClass",E(11,y,e.averageRating>=4)),a(2),u("ngClass",E(13,y,e.averageRating>=5))}}function ze(l,i){if(l&1&&(o(0,"div",46)(1,"div",47),M(2,"img",63),o(3,"div",49)(4,"div",50),p(5),d(6,"translate"),r(),o(7,"div",51)(8,"span",64),p(9,"\u2605"),r(),o(10,"span",64),p(11,"\u2605"),r(),o(12,"span",64),p(13,"\u2605"),r(),o(14,"span",64),p(15,"\u2605"),r(),o(16,"span",64),p(17,"\u2605"),r()(),o(18,"div",52),p(19),d(20,"date"),r()()(),o(21,"p",54),p(22),d(23,"translate"),r()()),l&2){let e=i.$implicit;a(2),u("src","assets/default-avatar.png",L),a(3),h(e.businessmanName||c(6,14,"COMMON.USER")),a(3),I("filled",(e.rating||0)>=1),a(2),I("filled",(e.rating||0)>=2),a(2),I("filled",(e.rating||0)>=3),a(2),I("filled",(e.rating||0)>=4),a(2),I("filled",(e.rating||0)>=5),a(3),h(z(20,16,e.createdAt,"dd/MM/yy")),a(3),h(e.comment||c(23,19,"ADD_SUPPLIER.NO_COMMENTS"))}}function qe(l,i){if(l&1&&(o(0,"div",44),R(1,ze,24,21,"div",45),r()),l&2){let e=m(4);a(),u("ngForOf",e.reviews)}}function Qe(l,i){l&1&&(o(0,"div",56),p(1),d(2,"translate"),r()),l&2&&(a(),P(" ",c(2,1,"ADD_SUPPLIER.NO_REVIEWS")," "))}function je(l,i){if(l&1&&(o(0,"div",38),R(1,qe,2,1,"div",41)(2,Qe,3,3,"div",42),r()),l&2){let e=m(3);a(),u("ngIf",e.reviews.length>0),a(),u("ngIf",e.reviews.length===0)}}function Ye(l,i){if(l&1){let e=A();o(0,"div",59)(1,"div",23),f("click",function(){let t=_(e).$implicit,s=m(2);return g(s.selectSupplier(t.id))}),o(2,"h3",60),p(3),d(4,"translate"),r(),M(5,"div",25),r(),o(6,"div",26)(7,"div",27),M(8,"img",28),o(9,"span"),p(10),r()(),R(11,Fe,13,0,"div",29)(12,We,11,15,"div",29),o(13,"app-button",61),d(14,"translate"),f("click",function(){let t=_(e).$implicit,s=m(2);return g(s.showRequestFormFor(t))}),r()(),R(15,je,3,2,"div",62),r()}if(l&2){let e=i.$implicit,n=m(2);a(3),h(e.companyName||(e.profile==null?null:e.profile.companyName)||c(4,9,"ADD_SUPPLIER.NO_COMPANY_NAME")),a(2),I("expanded",n.selectedSupplierId===e.id),a(3),u("src",(e.profile==null?null:e.profile.logo)||"assets/default-avatar.png",L),a(2),h(e.email),a(),u("ngIf",!e.averageRating||e.averageRating===0),a(),u("ngIf",e.averageRating&&e.averageRating>0),a(),S("label",c(14,11,"ADD_SUPPLIER.SEND_REQUEST")),a(2),u("ngIf",n.selectedSupplierId===e.id)}}function He(l,i){if(l&1&&(o(0,"div",57),R(1,Ye,16,13,"div",58),r()),l&2){let e=m();a(),u("ngForOf",e.filteredSuppliers)}}function Ge(l,i){if(l&1){let e=A();o(0,"div",65)(1,"div",66),f("click",function(){_(e);let t=m();return g(t.cancelRequest())}),r(),o(2,"div",67)(3,"button",68),f("click",function(){_(e);let t=m();return g(t.cancelRequest())}),p(4,"\xD7"),r(),o(5,"div",69)(6,"h3"),p(7),d(8,"translate"),r(),o(9,"div",70)(10,"label"),p(11),d(12,"translate"),r(),o(13,"app-input",71),d(14,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.batchType,t)||(s.batchType=t),g(t)}),r()(),o(15,"div",70)(16,"label"),p(17),d(18,"translate"),r(),o(19,"app-input",72),d(20,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.batchColor,t)||(s.batchColor=t),g(t)}),r()(),o(21,"div",70)(22,"label"),p(23),d(24,"translate"),r(),o(25,"app-input",73),d(26,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.quantity,t)||(s.quantity=t),g(t)}),r()(),o(27,"div",70)(28,"label"),p(29),d(30,"translate"),r(),o(31,"app-input",72),d(32,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.address,t)||(s.address=t),g(t)}),r()(),o(33,"div",70)(34,"label"),p(35),d(36,"translate"),r(),o(37,"app-input",71),d(38,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.requestMessage,t)||(s.requestMessage=t),g(t)}),r()(),o(39,"app-button",74),d(40,"translate"),f("click",function(){_(e);let t=m();return g(t.sendRequest())}),r()()()()}if(l&2){let e=m();a(7),h(c(8,24,"ADD_SUPPLIER.REQUEST_FORM_TITLE")),a(4),h(c(12,26,"ADD_SUPPLIER.BATCH_TYPE")),a(2),S("placeholder",c(14,28,"ADD_SUPPLIER.ENTER_FABRIC_TYPE")),w("ngModel",e.batchType),u("fullWidth",!0),a(4),h(c(18,30,"ADD_SUPPLIER.BATCH_COLOR")),a(2),S("placeholder",c(20,32,"ADD_SUPPLIER.CHOOSE_COLOR")),w("ngModel",e.batchColor),u("fullWidth",!0),a(4),h(c(24,34,"ADD_SUPPLIER.QUANTITY")),a(2),S("placeholder",c(26,36,"ADD_SUPPLIER.ENTER_QUANTITY")),w("ngModel",e.quantity),u("fullWidth",!0),a(4),h(c(30,38,"ADD_SUPPLIER.ADDRESS")),a(2),S("placeholder",c(32,40,"ADD_SUPPLIER.ENTER_ADDRESS")),w("ngModel",e.address),u("fullWidth",!0),a(4),h(c(36,42,"ADD_SUPPLIER.COMMENT")),a(2),S("placeholder",c(38,44,"ADD_SUPPLIER.ADDITIONAL_COMMENT")),w("ngModel",e.requestMessage),u("fullWidth",!0),a(2),S("label",c(40,46,"ADD_SUPPLIER.CONFIRM")),u("loading",e.isLoading)("fullWidth",!0)}}function Ke(l,i){if(l&1){let e=A();o(0,"div",65)(1,"div",66),f("click",function(){_(e);let t=m();return g(t.cancelBatch())}),r(),o(2,"div",67)(3,"button",68),f("click",function(){_(e);let t=m();return g(t.cancelBatch())}),p(4,"\xD7"),r(),o(5,"div",75)(6,"h2"),p(7),d(8,"translate"),r(),o(9,"div",70)(10,"label"),p(11),d(12,"translate"),r(),o(13,"app-input",72),d(14,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.code,t)||(s.newBatch.code=t),g(t)}),r()(),o(15,"div",70)(16,"label"),p(17),d(18,"translate"),r(),o(19,"app-input",72),d(20,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.client,t)||(s.newBatch.client=t),g(t)}),r()(),o(21,"div",70)(22,"label"),p(23),d(24,"translate"),r(),o(25,"app-input",72),d(26,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.fabricType,t)||(s.newBatch.fabricType=t),g(t)}),r()(),o(27,"div",70)(28,"label"),p(29),d(30,"translate"),r(),o(31,"app-input",72),d(32,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.color,t)||(s.newBatch.color=t),g(t)}),r()(),o(33,"div",76)(34,"div",77)(35,"label"),p(36),d(37,"translate"),r(),o(38,"app-input",73),d(39,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.quantity,t)||(s.newBatch.quantity=t),g(t)}),r()(),o(40,"div",77)(41,"label"),p(42),d(43,"translate"),r(),o(44,"app-input",73),d(45,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.price,t)||(s.newBatch.price=t),g(t)}),r()()(),o(46,"div",70)(47,"label"),p(48),d(49,"translate"),r(),o(50,"app-input",72),d(51,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.address,t)||(s.newBatch.address=t),g(t)}),r()(),o(52,"div",70)(53,"label"),p(54),d(55,"translate"),r(),o(56,"app-input",78),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.date,t)||(s.newBatch.date=t),g(t)}),r()(),o(57,"div",70)(58,"label"),p(59),d(60,"translate"),r(),o(61,"app-input",71),d(62,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newBatch.observations,t)||(s.newBatch.observations=t),g(t)}),r()(),o(63,"app-button",74),d(64,"translate"),f("click",function(){_(e);let t=m();return g(t.createBatch())}),r()()()()}if(l&2){let e=m();a(7),h(c(8,39,"ADD_SUPPLIER.CREATE_NEW_BATCH")),a(4),h(c(12,41,"ADD_SUPPLIER.BATCH_CODE")),a(2),S("placeholder",c(14,43,"ADD_SUPPLIER.BATCH_CODE")),w("ngModel",e.newBatch.code),u("fullWidth",!0),a(4),h(c(18,45,"ADD_SUPPLIER.CLIENT")),a(2),S("placeholder",c(20,47,"ADD_SUPPLIER.CLIENT")),w("ngModel",e.newBatch.client),u("fullWidth",!0),a(4),h(c(24,49,"ADD_SUPPLIER.FABRIC_TYPE")),a(2),S("placeholder",c(26,51,"ADD_SUPPLIER.FABRIC_TYPE")),w("ngModel",e.newBatch.fabricType),u("fullWidth",!0),a(4),h(c(30,53,"ADD_SUPPLIER.COLOR")),a(2),S("placeholder",c(32,55,"ADD_SUPPLIER.COLOR")),w("ngModel",e.newBatch.color),u("fullWidth",!0),a(5),h(c(37,57,"ADD_SUPPLIER.QUANTITY")),a(2),S("placeholder",c(39,59,"ADD_SUPPLIER.QUANTITY")),w("ngModel",e.newBatch.quantity),u("fullWidth",!0),a(4),h(c(43,61,"ADD_SUPPLIER.PRICE")),a(2),S("placeholder",c(45,63,"ADD_SUPPLIER.PRICE")),w("ngModel",e.newBatch.price),u("fullWidth",!0),a(4),h(c(49,65,"ADD_SUPPLIER.ADDRESS")),a(2),S("placeholder",c(51,67,"ADD_SUPPLIER.ADDRESS")),w("ngModel",e.newBatch.address),u("fullWidth",!0),a(4),h(c(55,69,"ADD_SUPPLIER.DATE")),a(2),w("ngModel",e.newBatch.date),u("fullWidth",!0),a(3),h(c(60,71,"ADD_SUPPLIER.OBSERVATIONS")),a(2),S("placeholder",c(62,73,"ADD_SUPPLIER.OBSERVATIONS")),w("ngModel",e.newBatch.observations),u("fullWidth",!0),a(2),S("label",c(64,75,"ADD_SUPPLIER.CREATE_BATCH")),u("loading",e.isLoading)("fullWidth",!0)}}function Je(l,i){if(l&1){let e=A();o(0,"div",65)(1,"div",66),f("click",function(){_(e);let t=m();return g(t.closeReviewForm())}),r(),o(2,"div",79)(3,"button",68),f("click",function(){_(e);let t=m();return g(t.closeReviewForm())}),p(4,"\xD7"),r(),o(5,"div",80)(6,"h2"),p(7),d(8,"translate"),r(),o(9,"div",70)(10,"label"),p(11),d(12,"translate"),r(),o(13,"div",81)(14,"div",82)(15,"span",83),f("click",function(){_(e);let t=m();return g(t.setRating(1))})("mouseenter",function(){_(e);let t=m();return g(t.hoverRating(1))})("mouseleave",function(){_(e);let t=m();return g(t.hoverRating(0))}),p(16,"\u2605"),r(),o(17,"span",83),f("click",function(){_(e);let t=m();return g(t.setRating(2))})("mouseenter",function(){_(e);let t=m();return g(t.hoverRating(2))})("mouseleave",function(){_(e);let t=m();return g(t.hoverRating(0))}),p(18,"\u2605"),r(),o(19,"span",83),f("click",function(){_(e);let t=m();return g(t.setRating(3))})("mouseenter",function(){_(e);let t=m();return g(t.hoverRating(3))})("mouseleave",function(){_(e);let t=m();return g(t.hoverRating(0))}),p(20,"\u2605"),r(),o(21,"span",83),f("click",function(){_(e);let t=m();return g(t.setRating(4))})("mouseenter",function(){_(e);let t=m();return g(t.hoverRating(4))})("mouseleave",function(){_(e);let t=m();return g(t.hoverRating(0))}),p(22,"\u2605"),r(),o(23,"span",83),f("click",function(){_(e);let t=m();return g(t.setRating(5))})("mouseenter",function(){_(e);let t=m();return g(t.hoverRating(5))})("mouseleave",function(){_(e);let t=m();return g(t.hoverRating(0))}),p(24,"\u2605"),r()(),o(25,"div",84),p(26),r()()(),o(27,"div",70)(28,"label"),p(29),d(30,"translate"),r(),o(31,"app-input",71),d(32,"translate"),C("ngModelChange",function(t){_(e);let s=m();return b(s.newReview.comment,t)||(s.newReview.comment=t),g(t)}),r()(),o(33,"app-button",74),d(34,"translate"),f("click",function(){_(e);let t=m();return g(t.submitReview())}),r()()()()}if(l&2){let e=m();a(7),h(e.isEditingReview?"ADD_SUPPLIER.EDIT_REVIEW":c(8,30,"ADD_SUPPLIER.ADD_REVIEW")),a(4),h(c(12,32,"ADD_SUPPLIER.RATING")),a(4),I("active",1<=e.newReview.rating)("hover",1<=e.hoverRatingValue&&e.hoverRatingValue>0),a(2),I("active",2<=e.newReview.rating)("hover",2<=e.hoverRatingValue&&e.hoverRatingValue>0),a(2),I("active",3<=e.newReview.rating)("hover",3<=e.hoverRatingValue&&e.hoverRatingValue>0),a(2),I("active",4<=e.newReview.rating)("hover",4<=e.hoverRatingValue&&e.hoverRatingValue>0),a(2),I("active",5<=e.newReview.rating)("hover",5<=e.hoverRatingValue&&e.hoverRatingValue>0),a(3),P(" ",e.newReview.rating,"/5 "),a(3),h(c(30,34,"ADD_SUPPLIER.COMMENT")),a(2),S("placeholder",c(32,36,"ADD_SUPPLIER.WRITE_OPINION")),w("ngModel",e.newReview.comment),u("fullWidth",!0),a(2),S("label",c(34,38,"ADD_SUPPLIER.PUBLISH_REVIEW")),u("loading",e.isLoading)("fullWidth",!0)}}var Se=class l{constructor(i,e,n,t,s,x){this.supplierService=i;this.requestService=e;this.reviewService=n;this.batchService=t;this.authService=s;this.translate=x;let v=this.authService.getCurrentUser();v&&v.id?(this.currentUserId=v.id,this.currentUserName=v.name||"Usuario",this.newBatch.businessmanId=this.currentUserId):(console.error("No hay usuario autenticado o falta ID"),this.authService.logout())}activeTab="current";searchTerm="";suppliers=[];filteredSuppliers=[];isLoading=!1;selectedSupplierId=null;currentUserId="";currentUserName="";isBatchSubmitting=!1;showRequestForm=!1;selectedSupplier=null;batchType="";batchColor="";quantity=0;address="";requestMessage="";showBatchForm=!1;newBatch=new _e({code:"",client:"",businessmanId:"",supplierId:"",fabricType:"",color:"",quantity:0,price:0,observations:"",address:"",date:new Date().toISOString().split("T")[0],status:q.POR_ENVIAR,imageUrl:""});reviews=[];showReviewForm=!1;expandedSupplierId=null;newReview={rating:5,comment:""};canAddReview=!1;selectedReviewSupplierId=null;isEditingReview=!1;editingReviewId=null;isSubmitting=!1;hoverRatingValue=0;connectedSuppliers=[];availableSuppliers=[];colors=["Rojo","Azul","Verde","Negro","Blanco","Amarillo","Morado","Naranja","Gris"];notification={show:!1,message:"",type:"success"};ngOnInit(){this.loadData()}setActiveTab(i){this.activeTab=i,this.updateDisplayedSuppliers()}loadData(){this.isLoading=!0,this.requestService.getRequestsByBusinessman(this.currentUserId).subscribe({next:i=>{let e=i.filter(n=>n.status.toUpperCase()==="ACCEPTED").map(n=>F(k({},n),{supplierId:n.supplierId.toString()}));this.supplierService.getAllSuppliers().subscribe({next:n=>{let t=n.map(s=>F(k({},s),{id:this.fixSupplierId(s),profile:this.ensureProfile(s)}));this.updateSupplierLists(t,e),this.isLoading=!1},error:n=>this.handleError(n)})},error:i=>this.handleError(i)})}updateSupplierLists(i,e){this.connectedSuppliers=i.filter(n=>e.some(t=>t.supplierId===n.id)),this.availableSuppliers=i.filter(n=>!this.connectedSuppliers.some(t=>t.id===n.id)),this.calculateInitialRatingsForAllSuppliers(),this.updateDisplayedSuppliers(),console.log("Proveedores conectados:",this.connectedSuppliers),console.log("Proveedores disponibles:",this.availableSuppliers)}handleError(i){console.error("Error:",i),this.isLoading=!1,this.showNotification(this.translate.instant("ADD_SUPPLIER.LOAD_ERROR"),"error")}calculateInitialRatingsForAllSuppliers(){console.log("\u{1F504} Calculando ratings iniciales para todos los suppliers..."),this.connectedSuppliers.forEach(i=>{this.calculateInitialRatingForSupplier(i)}),this.availableSuppliers.forEach(i=>{this.calculateInitialRatingForSupplier(i)})}calculateInitialRatingForSupplier(i){this.reviewService.getReviewsForSupplier(i.id,e=>{if(e&&e.length>0){let t=e.reduce((s,x)=>s+x.rating,0)/e.length;i.averageRating=t,i.totalReviews=e.length,console.log(`\u2705 Rating inicial calculado para ${i.companyName}: ${t} (${e.length} rese\xF1as)`)}else i.averageRating=0,i.totalReviews=0,console.log(`\u{1F4DD} Sin rese\xF1as para ${i.companyName}`)})}fixSupplierId(i){return i.email==="jime@gmail.com"?"3":i.email==="supplier1@gmail.com"?"4":i.email==="edu@gmail.com"?"5":i.id?.toString()||""}ensureProfile(i){return i.profile||{companyName:i.companyName||this.generateCompanyName(i),specialization:i.specialization||"",productCategories:i.productCategories||[],warehouseLocation:i.warehouseLocation||"",minimumOrderQuantity:i.minimumOrderQuantity||0,logo:i.logo||""}}generateCompanyName(i){if(i.email){let e=i.email.split("@")[0];return`${e.charAt(0).toUpperCase()+e.slice(1)} Company`}return i.name?`${i.name} Enterprise`:"Empresa sin nombre"}updateDisplayedSuppliers(){this.activeTab==="current"?this.filteredSuppliers=[...this.connectedSuppliers]:this.filteredSuppliers=[...this.availableSuppliers],this.searchTerm.trim()&&this.searchSuppliers()}searchSuppliers(){if(!this.searchTerm.trim()){this.updateDisplayedSuppliers();return}this.isLoading=!0;let i=this.activeTab==="current"?this.connectedSuppliers:this.availableSuppliers;this.filteredSuppliers=i.filter(e=>e.email?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.companyName?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.profile?.companyName?.toLowerCase().includes(this.searchTerm.toLowerCase())),this.isLoading=!1,this.filteredSuppliers.length===0&&this.showNotification(this.translate.instant("ADD_SUPPLIER.NO_SEARCH_RESULTS"),"info")}selectSupplier(i){if(this.selectedSupplierId===i){this.selectedSupplierId=null;return}this.selectedSupplierId=i,this.selectedSupplier=this.filteredSuppliers.find(e=>e.id===i),this.loadReviews(i)}toggleSupplierExpansion(i){this.expandedSupplierId===i?this.expandedSupplierId=null:(this.expandedSupplierId=i,this.loadReviews(i),this.checkIfCanAddReview(i))}loadReviews(i){if(!i){console.error("\u274C supplierId is null or undefined");return}this.reviewService.getReviewsForSupplier(i,e=>{this.reviews=e,this.reviews.forEach(n=>{n.canEdit=n.businessmanId===this.currentUserId}),this.calculateAndUpdateRating(i,e)})}calculateAndUpdateRating(i,e){if(!e||e.length===0){console.log("\u{1F4CA} No hay rese\xF1as para calcular rating"),this.updateSupplierRatingInLists(i,0,0);return}let t=e.reduce((s,x)=>s+x.rating,0)/e.length;console.log("\u{1F4CA} Rating calculado:",t,"Total rese\xF1as:",e.length),this.updateSupplierRatingInLists(i,t,e.length)}updateSupplierRatingInLists(i,e,n){let t=this.filteredSuppliers.find(v=>v.id===i),s=this.connectedSuppliers.find(v=>v.id===i),x=this.availableSuppliers.find(v=>v.id===i);t&&(t.averageRating=e,t.totalReviews=n,console.log("\u2705 Rating actualizado en filteredSuppliers")),s&&(s.averageRating=e,s.totalReviews=n,console.log("\u2705 Rating actualizado en connectedSuppliers")),x&&(x.averageRating=e,x.totalReviews=n,console.log("\u2705 Rating actualizado en availableSuppliers"))}checkIfCanAddReview(i){this.reviewService.hasBusinessmanReviewed(i,this.currentUserId,e=>{this.canAddReview=!e})}closeReviewForm(){this.showReviewForm=!1,this.isEditingReview=!1,this.editingReviewId=null,this.hoverRatingValue=0,this.newReview={rating:5,comment:""}}submitReview(){if(!this.selectedReviewSupplierId||this.isSubmitting)return;if(this.newReview.rating<1||this.newReview.rating>5){this.showNotification(this.translate.instant("ADD_SUPPLIER.RATING_RANGE_ERROR"),"warning");return}this.isLoading=!0,this.isSubmitting=!0;let i=this.selectedReviewSupplierId;this.isEditingReview&&this.editingReviewId?this.reviewService.updateReview(this.editingReviewId,this.newReview.rating,this.newReview.comment).subscribe({next:()=>{this.showNotification(this.translate.instant("ADD_SUPPLIER.REVIEW_UPDATED_SUCCESS"),"success"),this.closeReviewForm(),this.loadReviews(i),this.updateSupplierRating()},error:e=>{console.error("Error al actualizar rese\xF1a:",e),this.showNotification(this.translate.instant("ADD_SUPPLIER.REVIEW_ERROR"),"error")},complete:()=>{this.isLoading=!1,this.isSubmitting=!1,this.selectedReviewSupplierId=null}}):this.reviewService.addReview(this.selectedReviewSupplierId,this.currentUserId,this.newReview.rating,this.newReview.comment,this.currentUserName).subscribe({next:()=>{this.showNotification(this.translate.instant("ADD_SUPPLIER.REVIEW_ADDED_SUCCESS"),"success"),this.closeReviewForm(),this.loadReviews(i),this.updateSupplierRating(),this.canAddReview=!1},error:e=>{console.error("Error al agregar rese\xF1a:",e),this.showNotification(this.translate.instant("ADD_SUPPLIER.REVIEW_ERROR"),"error")},complete:()=>{this.isLoading=!1,this.isSubmitting=!1,this.selectedReviewSupplierId=null}})}updateSupplierRating(){let i=this.selectedReviewSupplierId||this.expandedSupplierId;i?this.reviewService.calculateAverageRating(i,(e,n)=>{console.log("\u{1F522} Calculando rating para supplier:",i),this.updateSupplierRatingInLists(i,e,n)}):console.warn("\u26A0\uFE0F No hay supplierId v\xE1lido para actualizar rating")}showRequestFormFor(i){this.selectedSupplier=i,this.selectedSupplierId=i.id,this.showRequestForm=!0,this.batchType="",this.batchColor="",this.quantity=0,this.address="",this.requestMessage=""}cancelRequest(){this.showRequestForm=!1,this.batchType="",this.batchColor="",this.quantity=0,this.address="",this.requestMessage=""}showBatchFormFor(i){this.selectedSupplier=i,this.selectedSupplierId=i.id,this.showBatchForm=!0;let e=new Date().toISOString().split("T")[0];this.newBatch={code:"L-"+Math.floor(1e3+Math.random()*9e3),client:this.currentUserName,businessmanId:this.currentUserId,supplierId:i.id,fabricType:"",color:"",quantity:0,price:0,observations:"",address:"",date:e,status:q.PENDIENTE,imageUrl:""}}cancelBatch(){this.showBatchForm=!1,this.selectedSupplierId=null}createBatch(){if(!this.isBatchSubmitting){if(!this.newBatch.fabricType){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.FABRIC_TYPE_REQUIRED"),"warning");return}if(!this.newBatch.color){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.COLOR_REQUIRED"),"warning");return}if(!this.newBatch.quantity||this.newBatch.quantity<=0){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.QUANTITY_REQUIRED"),"warning");return}if(!this.newBatch.price||this.newBatch.price<=0){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.PRICE_REQUIRED"),"warning");return}if(!this.newBatch.address){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.ADDRESS_REQUIRED"),"warning");return}this.isLoading=!0,this.isBatchSubmitting=!0,this.batchService.createBatch(this.newBatch.code,this.newBatch.client,this.newBatch.businessmanId,this.newBatch.supplierId,this.newBatch.fabricType,this.newBatch.color,this.newBatch.price,this.newBatch.quantity,this.newBatch.observations||"",this.newBatch.address,this.newBatch.date,this.newBatch.imageUrl).subscribe({next:()=>{this.showNotification(this.translate.instant("ADD_SUPPLIER.BATCH_CREATED_SUCCESS"),"success"),this.showBatchForm=!1,this.isLoading=!1,this.isBatchSubmitting=!1},error:i=>{console.error("Error al crear lote:",i),this.showNotification(this.translate.instant("ADD_SUPPLIER.BATCH_ERROR"),"error"),this.isLoading=!1,this.isBatchSubmitting=!1}})}}sendRequest(){if(!this.selectedSupplierId){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.SELECT_SUPPLIER"),"warning");return}if(this.showRequestForm){if(!this.batchType){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.FABRIC_TYPE_REQUIRED"),"warning");return}if(!this.batchColor){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.COLOR_REQUIRED"),"warning");return}if(this.quantity<=0){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.QUANTITY_REQUIRED"),"warning");return}if(!this.address){this.showNotification(this.translate.instant("ADD_SUPPLIER.VALIDATION_ERRORS.ADDRESS_REQUIRED"),"warning");return}}if(this.isLoading)return;let i=this.selectedSupplierId;this.isLoading=!0,this.requestService.checkExistingRequest(this.currentUserId,i).subscribe({next:e=>{this.requestService.createRequest(this.currentUserId,i,this.requestMessage,this.batchType,this.batchColor,this.quantity,this.address).subscribe({next:()=>{this.showNotification(this.translate.instant("ADD_SUPPLIER.REQUEST_SENT_SUCCESS"),"success"),this.showRequestForm=!1,this.batchType="",this.batchColor="",this.quantity=0,this.address="",this.requestMessage="",this.isLoading=!1,this.loadData()},error:n=>{console.error("Error al enviar solicitud:",n),this.showNotification(this.translate.instant("ADD_SUPPLIER.REQUEST_ERROR"),"error"),this.isLoading=!1}})},error:e=>{console.error("Error al verificar solicitudes existentes:",e),this.showNotification(this.translate.instant("ADD_SUPPLIER.REQUEST_CHECK_ERROR"),"error"),this.isLoading=!1}})}showNotification(i,e){this.notification={show:!0,message:i,type:e}}closeNotification(){this.notification.show=!1}setRating(i){this.newReview.rating=i}hoverRating(i){this.hoverRatingValue=i}openReviewForm(i){this.selectedReviewSupplierId=i,this.showReviewForm=!0,this.isEditingReview=!1,this.editingReviewId=null,this.hoverRatingValue=0,this.newReview={rating:5,comment:""}}editReview(i){this.selectedReviewSupplierId=i.supplierId,this.editingReviewId=i.id,this.isEditingReview=!0,this.showReviewForm=!0,this.hoverRatingValue=0,this.newReview={rating:i.rating,comment:i.comment}}onSearchInput(){(this.searchTerm.length>2||this.searchTerm.length===0)&&this.searchSuppliers()}clearSearch(){this.searchTerm="",this.searchSuppliers()}static \u0275fac=function(e){return new(e||l)(O(ve),O(xe),O(N),O(ge),O(ce),O(ie))};static \u0275cmp=K({type:l,selectors:[["app-add-supplier"]],decls:28,vars:32,consts:[[1,"container"],[1,"tab-navigation"],[1,"tab-button",3,"click"],[1,"search-container"],[1,"search-input-wrapper"],[1,"material-icons","search-icon"],["type","text",1,"search-input",3,"ngModelChange","keyup.enter","input","placeholder","ngModel"],["class","clear-button",3,"click",4,"ngIf"],["variant","primary","icon","filter_list",3,"click","label"],["class","loading",4,"ngIf"],["class","no-results",4,"ngIf"],["class","suppliers-grid",4,"ngIf"],["class","suppliers-list",4,"ngIf"],["class","modal",4,"ngIf"],[3,"close","show","message","type","autoClose"],[1,"clear-button",3,"click"],[1,"material-icons"],[1,"loading"],[1,"no-results"],[4,"ngIf"],[1,"suppliers-grid"],["class","supplier-card",4,"ngFor","ngForOf"],[1,"supplier-card"],[1,"supplier-header",3,"click"],[1,"supplier-title"],[1,"dropdown-arrow"],[1,"supplier-info"],[1,"supplier-email"],["alt","avatar",1,"supplier-avatar",3,"src"],["class","supplier-rating",4,"ngIf"],["variant","primary",3,"click","label","fullWidth"],["class","supplier-expanded",4,"ngIf"],[1,"supplier-rating"],[1,"star","empty"],[1,"no-rating-text"],[1,"star",3,"ngClass"],[1,"supplier-expanded"],[1,"supplier-details"],[1,"reviews-section"],[1,"reviews-header"],["variant","primary","size","small",3,"label","click",4,"ngIf"],["class","reviews-list",4,"ngIf"],["class","no-reviews",4,"ngIf"],["variant","primary","size","small",3,"click","label"],[1,"reviews-list"],["class","review-item",4,"ngFor","ngForOf"],[1,"review-item"],[1,"review-header"],["alt","reviewer","onerror","this.src='assets/default-avatar.png'",1,"reviewer-avatar",3,"src"],[1,"review-info"],[1,"review-email"],[1,"review-rating"],[1,"review-date"],["variant","secondary","size","small",3,"label","click",4,"ngIf"],[1,"review-text"],["variant","secondary","size","small",3,"click","label"],[1,"no-reviews"],[1,"suppliers-list"],["class","supplier-item",4,"ngFor","ngForOf"],[1,"supplier-item"],[1,"supplier-name"],["variant","primary",3,"click","label"],["class","reviews-section",4,"ngIf"],["alt","reviewer",1,"reviewer-avatar",3,"src"],[1,"star"],[1,"modal"],[1,"modal-backdrop",3,"click"],[1,"modal-content"],[1,"close-modal",3,"click"],[1,"request-form"],[1,"form-group"],["type","textarea",3,"ngModelChange","ngModel","placeholder","fullWidth"],["type","text",3,"ngModelChange","ngModel","placeholder","fullWidth"],["type","number",3,"ngModelChange","ngModel","placeholder","fullWidth"],["variant","primary",3,"click","label","loading","fullWidth"],[1,"batch-form"],[1,"form-row"],[1,"form-group","half"],["type","date",3,"ngModelChange","ngModel","fullWidth"],[1,"modal-content","review-modal"],[1,"review-form"],[1,"star-rating-container"],[1,"clickable-stars"],[1,"star-click",3,"click","mouseenter","mouseleave"],[1,"rating-display"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),f("click",function(){return n.setActiveTab("current")}),p(3),d(4,"translate"),r(),o(5,"div",2),f("click",function(){return n.setActiveTab("add")}),p(6),d(7,"translate"),r()(),o(8,"div",3)(9,"div",4)(10,"i",5),p(11,"search"),r(),o(12,"input",6),d(13,"translate"),C("ngModelChange",function(s){return b(n.searchTerm,s)||(n.searchTerm=s),s}),f("keyup.enter",function(){return n.searchSuppliers()})("input",function(){return n.onSearchInput()}),r(),R(14,Re,3,0,"button",7),r(),o(15,"app-button",8),d(16,"translate"),f("click",function(){return n.searchSuppliers()}),r()(),o(17,"h2"),p(18),d(19,"translate"),r(),R(20,Ee,3,3,"div",9)(21,Ae,4,3,"div",10)(22,ke,2,1,"div",11)(23,He,2,1,"div",12)(24,Ge,41,48,"div",13)(25,Ke,65,77,"div",13)(26,Je,35,40,"div",13),o(27,"app-notification",14),f("close",function(){return n.closeNotification()}),r()()),e&2&&(a(2),I("active",n.activeTab==="current"),a(),P(" ",c(4,22,"ADD_SUPPLIER.CURRENT_SUPPLIERS")," "),a(2),I("active",n.activeTab==="add"),a(),P(" ",c(7,24,"ADD_SUPPLIER.ADD_SUPPLIER")," "),a(6),S("placeholder",c(13,26,"ADD_SUPPLIER.SEARCH_PLACEHOLDER")),w("ngModel",n.searchTerm),a(2),u("ngIf",n.searchTerm),a(),S("label",c(16,28,"COMMON.FILTER")),a(3),h(c(19,30,"ADD_SUPPLIER.SUPPLIERS")),a(2),u("ngIf",n.isLoading),a(),u("ngIf",!n.isLoading&&n.filteredSuppliers.length===0),a(),u("ngIf",n.activeTab==="current"),a(),u("ngIf",n.activeTab==="add"),a(),u("ngIf",n.showRequestForm),a(),u("ngIf",n.showBatchForm),a(),u("ngIf",n.showReviewForm),a(),u("show",n.notification.show)("message",n.notification.message)("type",n.notification.type)("autoClose",!0))},dependencies:[te,X,Z,$,ee,pe,ae,oe,se,me,ue,he,re,ne],styles:['.supplier-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;margin:8px 0;padding:4px 0}.supplier-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]{font-size:18px!important;display:inline-block!important;width:20px!important;text-align:center!important;line-height:1!important;transform:none!important;transition:none!important;animation:none!important;margin-right:2px!important;position:static!important;background:none!important;border:none!important;box-shadow:none!important;text-shadow:none!important}.supplier-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]:hover{transform:none!important;transition:none!important;animation:none!important;scale:none!important;background:none!important;box-shadow:none!important}.star.empty[_ngcontent-%COMP%]{color:#999!important}.star[_ngcontent-%COMP%]{font-size:20px;color:#ddd;line-height:1;font-weight:400;font-style:normal;display:inline-block;vertical-align:middle;transition:none!important;text-shadow:none;transform:none!important;animation:none!important}.star[_ngcontent-%COMP%]:hover{transform:none!important;transition:none!important;animation:none!important;scale:none!important}.star.filled[_ngcontent-%COMP%]{color:#ffc107!important}.review-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2px;margin:4px 0}.review-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]{font-size:14px!important;display:inline-block!important;width:16px!important;text-align:center!important;transform:none!important;transition:none!important;animation:none!important;margin-right:2px!important;position:static!important;background:none!important;border:none!important;box-shadow:none!important;text-shadow:none!important}.review-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]:hover{transform:none!important;transition:none!important;animation:none!important;scale:none!important;background:none!important;box-shadow:none!important}.star[_ngcontent-%COMP%]:not(.star-click){transform:none!important;transition:none!important;animation:none!important;position:static!important;background:none!important;border:none!important;box-shadow:none!important;text-shadow:none!important}.star[_ngcontent-%COMP%]:not(.star-click):hover{transform:none!important;transition:none!important;animation:none!important;scale:none!important;background:none!important;box-shadow:none!important}.star-rating-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px;padding:24px;background:linear-gradient(135deg,#ffc10708,#ffc10714);border-radius:16px;border:2px solid rgba(255,193,7,.2);transition:all .3s ease;margin:12px 0;box-shadow:0 4px 20px #ffc1071a;position:relative;overflow:hidden}.star-rating-container[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ffc10714,#ffc10726);border-color:#ffc10766;box-shadow:0 8px 30px #ffc10733;transform:translateY(-2px)}.clickable-stars[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;position:relative;z-index:1}.star-click[_ngcontent-%COMP%]{font-size:44px;color:#e0e0e0;cursor:pointer;transition:all .3s ease;-webkit-user-select:none;user-select:none;text-shadow:0 3px 8px rgba(0,0,0,.15);transform-origin:center;line-height:1;display:inline-flex;align-items:center;justify-content:center;width:56px;height:56px;border-radius:50%;position:relative;background:#fff9;border:2px solid transparent}.star-click.active[_ngcontent-%COMP%]{color:#ffc107!important;text-shadow:0 4px 15px rgba(255,193,7,.7);transform:scale(1.15);background:#ffc10733;border-color:#ffc10766}.rating-display[_ngcontent-%COMP%]{font-size:24px;font-weight:800;color:#333;background:linear-gradient(135deg,#ffc10740,#ffc10726);padding:16px 28px;border-radius:16px;border:3px solid rgba(255,193,7,.3);min-width:80px;text-align:center;box-shadow:0 6px 20px #ffc10733;transition:all .3s ease;letter-spacing:1px;position:relative;z-index:1}.rating-display[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 8px 25px #ffc1074d}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px;height:auto;overflow:hidden}.tab-navigation[_ngcontent-%COMP%]{display:flex;background:#fff;border-radius:12px;box-shadow:0 2px 8px #00000014;margin-bottom:20px;overflow:hidden;position:relative}.tab-button[_ngcontent-%COMP%]{flex:1;padding:16px 20px;font-size:14px;cursor:pointer;text-align:center;color:#666;background:transparent;border:none;position:relative;transition:all .3s cubic-bezier(.4,0,.2,1);font-weight:500}.tab-button[_ngcontent-%COMP%]:hover{background-color:#a68b6b0d;color:var(--primary-color)}.tab-button.active[_ngcontent-%COMP%]{color:var(--primary-color);background-color:#a68b6b1a}.tab-button.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--primary-color),var(--primary-dark));border-radius:2px 2px 0 0}.search-container[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;margin:20px 0;max-width:800px;width:100%}.search-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;background:#fff;border:2px solid #e0e0e0;border-radius:12px;box-shadow:0 2px 8px #00000014;transition:all .3s ease;min-height:48px;flex:1;overflow:hidden}.search-input-wrapper[_ngcontent-%COMP%]:hover{border-color:#a68b6b;box-shadow:0 4px 12px #a68b6b26}.search-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#a68b6b;box-shadow:0 0 0 3px #a68b6b26}.search-icon[_ngcontent-%COMP%]{position:absolute;left:16px;color:#666;font-size:20px!important;z-index:2;transition:color .3s ease;width:20px!important;height:20px!important}.search-input-wrapper[_ngcontent-%COMP%]:focus-within   .search-icon[_ngcontent-%COMP%]{color:#a68b6b}.search-input[_ngcontent-%COMP%]{width:100%;border:none;outline:none;background:transparent;padding:14px 50px 14px 52px;font-size:16px;color:#333;font-family:inherit}.search-input[_ngcontent-%COMP%]::placeholder{color:#999;font-weight:400}.clear-button[_ngcontent-%COMP%]{position:absolute;right:12px;background:none;border:none;cursor:pointer;color:#999;padding:4px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.clear-button[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;color:#666}.clear-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:18px!important}h2[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin-bottom:20px;color:var(--text-dark);display:flex;align-items:center;gap:12px}h2[_ngcontent-%COMP%]:before{content:"store";font-family:Material Icons;font-size:20px;color:var(--primary-color)}.loading[_ngcontent-%COMP%], .no-results[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:60px 20px;color:#666;background:transparent;border-radius:12px;box-shadow:0 2px 8px #00000014}.loading[_ngcontent-%COMP%]:before{content:"hourglass_empty";font-family:Material Icons;font-size:48px;margin-bottom:16px;color:var(--primary-color)}.no-results[_ngcontent-%COMP%]:before{content:"search_off";font-family:Material Icons;font-size:48px;margin-bottom:16px;color:#ccc}.suppliers-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}.supplier-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;box-shadow:0 4px 12px #00000014;overflow:hidden;transition:all .3s cubic-bezier(.4,0,.2,1);border:1px solid rgba(0,0,0,.05);position:relative}.supplier-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 25px #0000001f}.suppliers-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;overflow:hidden;height:100%}.supplier-item[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;box-shadow:0 2px 8px #0000000f;border:1px solid rgba(0,0,0,.05);transition:box-shadow .2s ease,transform .2s ease;overflow:visible}.supplier-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.supplier-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:18px;cursor:pointer;background:linear-gradient(135deg,#f8f9fa,#f1f3f4);border-bottom:1px solid rgba(0,0,0,.05);transition:all .2s ease}.supplier-header[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#a68b6b0d,#a68b6b1a)}.supplier-title[_ngcontent-%COMP%], .supplier-name[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:var(--text-dark);line-height:1.3}.dropdown-arrow[_ngcontent-%COMP%]{font-family:Material Icons;font-size:20px;color:#666;transition:all .3s cubic-bezier(.4,0,.2,1);padding:8px;border-radius:50%;background:#0000000d}.dropdown-arrow[_ngcontent-%COMP%]:before{content:"expand_more"}.dropdown-arrow.expanded[_ngcontent-%COMP%]{transform:rotate(180deg);background:#a68b6b26;color:var(--primary-color)}.supplier-info[_ngcontent-%COMP%]{padding:18px;display:flex;flex-direction:column;gap:16px}.supplier-email[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:14px;color:#555;padding:12px;background:#00000005;border-radius:8px}.supplier-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid rgba(166,139,107,.2);transition:all .2s ease}.supplier-avatar[_ngcontent-%COMP%]:hover{border-color:var(--primary-color);transform:scale(1.05)}.supplier-expanded[_ngcontent-%COMP%]{padding:18px;background:linear-gradient(135deg,#fafbfc,#f8f9fa);border-top:1px solid rgba(0,0,0,.05)}.supplier-details[_ngcontent-%COMP%]{margin-bottom:20px;padding:18px;background:#fff;border-radius:8px;box-shadow:0 2px 6px #0000000a}.supplier-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:var(--text-dark);font-size:16px;font-weight:600;display:flex;align-items:center;gap:8px}.supplier-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]:before{content:"info";font-family:Material Icons;font-size:16px;color:var(--primary-color)}.supplier-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:14px;line-height:1.5;color:#666}.supplier-details[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-dark);font-weight:500}.reviews-section[_ngcontent-%COMP%]{margin-top:16px;overflow:visible}.reviews-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:16px;background:#fff;border-radius:8px;box-shadow:0 2px 6px #0000000a}.reviews-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:var(--text-dark);font-size:16px;font-weight:600;display:flex;align-items:center;gap:8px}.reviews-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]:before{content:"star_rate";font-family:Material Icons;font-size:16px;color:#ffc107}.reviews-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.review-item[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;padding:16px;box-shadow:0 2px 8px #0000000f;border-left:4px solid rgba(166,139,107,.3);transition:all .2s ease}.review-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;border-left-color:var(--primary-color)}.review-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;margin-bottom:8px}.reviewer-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid rgba(166,139,107,.2);flex-shrink:0}.review-info[_ngcontent-%COMP%]{flex:1;min-width:0}.review-email[_ngcontent-%COMP%]{font-weight:600;font-size:14px;color:var(--text-dark);margin-bottom:4px}.review-date[_ngcontent-%COMP%]{color:#777;font-size:12px;margin-top:4px}.review-text[_ngcontent-%COMP%]{margin:12px 0 0;font-size:14px;line-height:1.6;color:#555}.no-reviews[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#777;font-style:italic;background:#fff;border-radius:8px;box-shadow:0 2px 6px #0000000a}.no-reviews[_ngcontent-%COMP%]:before{content:"comment";font-family:Material Icons;font-size:32px;display:block;margin-bottom:12px;color:#ccc}.modal[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:1000;display:flex;align-items:center;justify-content:center;padding:20px}.modal-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#0009;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{position:relative;background-color:#fff;border-radius:12px;box-shadow:0 20px 40px #0003;width:100%;max-width:500px;max-height:90vh;overflow-y:auto;z-index:1001}.review-modal[_ngcontent-%COMP%]{max-width:650px}.close-modal[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;background:#0000001a;border:none;border-radius:50%;width:32px;height:32px;font-size:18px;cursor:pointer;color:#666;transition:all .2s ease;z-index:10}.close-modal[_ngcontent-%COMP%]:hover{background:#0003;color:#333}.request-form[_ngcontent-%COMP%], .batch-form[_ngcontent-%COMP%], .review-form[_ngcontent-%COMP%]{padding:24px}.batch-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .review-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px;font-size:22px;font-weight:600;color:var(--text-dark)}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px}.form-group.half[_ngcontent-%COMP%]{flex:1}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:var(--text-dark);font-size:14px}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:16px}.search-container[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.suppliers-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.supplier-info[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.tab-button[_ngcontent-%COMP%]{font-size:13px;padding:12px 16px}.modal-content[_ngcontent-%COMP%]{margin:16px;max-width:calc(100% - 32px)}.review-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.star-click[_ngcontent-%COMP%]{font-size:36px;width:44px;height:44px}.clickable-stars[_ngcontent-%COMP%]{gap:8px}.rating-display[_ngcontent-%COMP%]{font-size:20px;padding:12px 20px;min-width:70px}.star-rating-container[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}}@media (max-width: 480px){h2[_ngcontent-%COMP%]{font-size:20px}.modal-content[_ngcontent-%COMP%]{border-radius:8px}.star-click[_ngcontent-%COMP%]{font-size:32px;width:40px;height:40px}.star[_ngcontent-%COMP%]{font-size:18px}.review-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]{font-size:14px}}']})};export{Se as AddSupplierComponent};
