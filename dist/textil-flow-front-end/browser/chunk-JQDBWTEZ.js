import{a as k,b as S}from"./chunk-7E74X2WU.js";import{d as O,e as M,k as y,w as P}from"./chunk-Z3ABZYYA.js";import"./chunk-GNQ3TXIC.js";import{$b as n,Fb as t,Gb as e,Lb as h,Pb as p,Qb as u,_a as l,ac as w,bc as d,da as v,kb as C,la as g,ma as _,pb as x,wb as f}from"./chunk-LJ6G2VOH.js";function I(a,c){if(a&1){let i=h();t(0,"button",8),p("click",function(){g(i);let s=u();return _(s.openNotifications())}),n(1," Mostrar notificaciones "),e()}}function T(a,c){if(a&1&&(t(0,"li"),n(1),e()),a&2){let i=c.$implicit;l(),w(i)}}function V(a,c){if(a&1&&(t(0,"li")(1,"div",17)(2,"strong"),n(3),e(),t(4,"ul"),x(5,T,2,1,"li",15),e()()()),a&2){let i=c.$implicit;l(3),d("Lote ",i.code,":"),l(2),f("ngForOf",i.messages)}}function D(a,c){if(a&1){let i=h();t(0,"div",9)(1,"div",10)(2,"div",11)(3,"span",12),n(4,"\u24D8"),e(),t(5,"h3"),n(6,"Notificaciones recientes"),e()(),t(7,"button",13),p("click",function(){g(i);let s=u();return _(s.closeNotifications())}),n(8,"\u2715"),e()(),t(9,"ul",14),x(10,V,6,2,"li",15),e(),t(11,"button",16),p("click",function(){g(i);let s=u();return _(s.viewMoreNotifications())}),n(12," Ver m\xE1s detalles "),e()()}if(a&2){let i=u();l(10),f("ngForOf",i.notificationsGrouped)}}var E=class a{batchService=v(k);authService=v(P);supplierName="Telas del Sur";lotSummary={pending:0,sent:0,confirmed:0};notificationsGrouped=[];showNotifications=!0;ngOnInit(){let c=this.authService.getCurrentUser();if(!c||!c.id){console.error("No hay usuario autenticado o falta ID"),this.authService.logout();return}let i=c.id;this.batchService.getBySupplierId(i).subscribe(r=>{let s={pending:0,sent:0,confirmed:0},m={},N=[...r].sort((o,b)=>new Date(b.date).getTime()-new Date(o.date).getTime());for(let o of N)o.status===S.POR_ENVIAR?(s.pending++,m[o.code]||(m[o.code]=[]),m[o.code].push(`Recuerda enviar el lote ${o.code} hoy.`),o.observations&&o.observations.trim()!==""&&m[o.code].push(`Dej\xF3 una observaci\xF3n en el lote ${o.code}.`),(!o.imageUrl||o.imageUrl.trim()==="")&&m[o.code].push(`Falta evidencia en el lote ${o.code}.`)):o.status===S.ENVIADO?s.sent++:s.confirmed++;this.lotSummary=s,this.notificationsGrouped=Object.entries(m).map(([o,b])=>({code:o,messages:b}))})}viewDetails(c){console.log(`Ver detalles de lotes ${c}`)}viewMoreNotifications(){console.log("Ver m\xE1s notificaciones")}closeNotifications(){this.showNotifications=!1}openNotifications(){this.showNotifications=!0}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=C({type:a,selectors:[["app-supplier-home"]],decls:30,vars:6,consts:[[1,"dashboard-container"],[1,"welcome-section"],[1,"stats-container"],[1,"stat-card"],[1,"stat-number"],[1,"btn-details",3,"click"],["class","btn-show-notifications",3,"click",4,"ngIf"],["class","notifications-container",4,"ngIf"],[1,"btn-show-notifications",3,"click"],[1,"notifications-container"],[1,"notifications-header"],[1,"notifications-title"],[1,"notification-icon"],[1,"close-btn",3,"click"],[1,"notifications-list"],[4,"ngFor","ngForOf"],[1,"btn-more-details",3,"click"],[1,"notification-item"]],template:function(i,r){i&1&&(t(0,"div",0)(1,"div",1)(2,"h1"),n(3),e(),t(4,"p"),n(5,"Aqu\xED tienes un resumen de tu actividad actual en TextilFlow."),e()(),t(6,"div",2)(7,"div",3)(8,"h2"),n(9,"Lotes por enviar"),e(),t(10,"p",4),n(11),e(),t(12,"button",5),p("click",function(){return r.viewDetails("pendientes")}),n(13,"Ver detalles"),e()(),t(14,"div",3)(15,"h2"),n(16,"Lotes enviados"),e(),t(17,"p",4),n(18),e(),t(19,"button",5),p("click",function(){return r.viewDetails("enviados")}),n(20,"Ver detalles"),e()(),t(21,"div",3)(22,"h2"),n(23,"Lotes confirmados"),e(),t(24,"p",4),n(25),e(),t(26,"button",5),p("click",function(){return r.viewDetails("confirmados")}),n(27,"Ver detalles"),e()()(),x(28,I,2,0,"button",6)(29,D,13,1,"div",7),e()),i&2&&(l(3),d("Bienvenido, ",r.supplierName,""),l(8),d("",r.lotSummary.pending," lotes"),l(7),d("",r.lotSummary.sent," lotes"),l(7),d("",r.lotSummary.confirmed," lotes"),l(3),f("ngIf",!r.showNotifications),l(),f("ngIf",r.showNotifications))},dependencies:[y,O,M],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px;max-width:900px;margin:0 auto;font-family:Arial,sans-serif}.welcome-section[_ngcontent-%COMP%]{margin-bottom:30px}.welcome-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;color:#333}.welcome-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-size:16px}.stats-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:30px;gap:20px}.stat-card[_ngcontent-%COMP%]{flex:1;background-color:#fff;border:1px solid #ddd;padding:20px;border-radius:4px;text-align:center}.stat-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;color:#555;margin-bottom:10px}.stat-number[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-bottom:15px;color:#333}.btn-details[_ngcontent-%COMP%]{background-color:#8a7155;color:#fff;border:none;padding:8px 15px;border-radius:4px;cursor:pointer;font-size:14px}.btn-details[_ngcontent-%COMP%]:hover{background-color:#6e5a43}.notifications-container[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:4px;padding:15px}.notifications-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.notifications-title[_ngcontent-%COMP%]{display:flex;align-items:center}.notification-icon[_ngcontent-%COMP%]{margin-right:10px;font-size:18px;color:#555}.notifications-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;color:#333;margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:16px;color:#777;cursor:pointer}.notifications-list[_ngcontent-%COMP%]{list-style-type:disc;padding-left:20px;margin-bottom:15px}.notifications-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;color:#555}.btn-more-details[_ngcontent-%COMP%]{background-color:#8a7155;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:14px;display:block;width:140px;text-align:center}.btn-show-notifications[_ngcontent-%COMP%]{background-color:#8a7155;color:#fff;border:none;padding:8px 15px;margin:10px 0;border-radius:4px;cursor:pointer;font-size:14px}.btn-show-notifications[_ngcontent-%COMP%]:hover{background-color:#6e5a43}"]})};export{E as SupplierHomeComponent};
